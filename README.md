### **MRI 图像重建与数据处理平台 (MRI Image Reconstruction & Processing Platform) 介绍**  

本程序是一款功能全面的图像处理软件，专为磁共振成像（MRI）领域的图像重建和数据预处理任务而设计。它提供了一个直观的图形用户界面（GUI），集成了多种先进的传统优化算法和前沿的深度学习模型，旨在为研究人员和工程师提供一个从原始数据到高质量图像的完整工作流解决方案。  

程序主要分为三大核心模块：**传统重建**、**压缩感知重建**和**深度学习重建**，并辅以强大的**数据处理**工具。  

---  

#### **1. 核心功能模块**  

**1.1 传统重建 (Traditional Reconstruction)**  
该模块提供基础的k-space到图像域的变换，是后续高级重建的基础。  

* **支持算法**:  
  * **FFT变换**: 对标准的笛卡尔网格采样数据执行快速傅里叶变换（FFT）。  
  * **NUFFT变换**: 对非笛卡尔采样轨迹（如径向、螺旋）的数据执行非均匀快速傅里叶变换，是处理非笛卡尔数据的关键步骤。  
* **输入**: 一组k-space数据文件（`.npy`）和一个描述采样点坐标的轨迹（traj）文件（仅NUFFT需要）。  
* **输出**: 经过变换后的图像（支持保存为`.npy`格式），并可在界面中预览。  


**1.2 压缩感知重建 (Compressed Sensing Reconstruction)**  
该模块专注于处理欠采样的k-space数据，利用先验知识（如图像在小波域的稀疏性或空间梯度的稀疏性）来重建高质量图像。  

* **支持算法**:  
  * **ADMM-TV**: 基于交替方向乘子法（ADMM）和全变分（Total Variation）正则化的经典优化算法，适用于图像去噪和重建。  
  * **Wavelet-ISTA**: 基于小波变换稀疏性和迭代软阈值算法（ISTA）的重建方法，能有效保留图像纹理。  
  * **NUFFT-Wavelet**: 结合非均匀快速傅里叶变换（NUFFT）和小波稀疏性的算法，专为处理非笛卡尔（如径向、螺旋）采样轨迹设计。  
  * **ADMM-TV-CuPy**: ADMM-TV算法的GPU加速版本，利用CuPy库在NVIDIA GPU上进行计算，显著提升处理速度（需配置CUDA环境）。  
* **输入**: 用户需提供一个或多个包含欠采样k-space数据的`.npy`文件，以及一个对应的采样掩码（mask）文件。  
* **输出**: 重建后的图像（支持保存为`.npy`格式），并可在界面中实时预览。  


**1.3 深度学习重建 (Deep Learning Reconstruction)**  
该模块集成了多个预训练的深度学习模型，代表了当前MRI加速重建的最先进技术，能够实现更快、更高质量的重建。  

* **支持模型**:  
  * **U-Net**: 经典的编码器-解码器结构，广泛应用于医学图像分割和去噪/重建，是端到端图像重建的代表。  
  * **MoDL (Model-Based Deep Learning)**: 将传统的迭代优化算法展开为深度网络，结合了物理模型和数据驱动的优势。  
  * **Transformer**: 基于自注意力机制的模型，能捕捉图像的长距离依赖关系，在图像生成任务中表现出色。  
  * **ISTA-Net**: 将ISTA迭代过程展开为深度网络，并学习最优的阈值和字典，是深度展开网络的代表。  
* **工作流程**:  
  1. 用户选择包含`undersampled`（欠采样k-space）和`mask`（采样掩码）子文件夹的输入目录。  
  2. 选择模型权重文件和配置文件。  
  3. 执行推理，模型将输出高质量的重建图像。  
* **输出**: 重建后的图像（可保存为`.png`和`.npy`格式），并在界面中与欠采样输入图像并排对比显示，便于效果评估。  

---  

#### **2. 数据处理工具 (Data Processing Tools)**  
此模块为构建深度学习数据集和进行数据预处理提供了便捷的工具链。  

* **创建数据集结构**: 一键生成符合训练要求的标准文件夹结构（包含`train`和`val`子集，以及`full`, `undersampled`, `mask`等目录）。  
* **FID文件转换**: 将原始的MRI FID（Free Induction Decay）数据文件转换为常见的图像格式（如PNG）或k-space数据。  
* **图像分组**: 将一个文件夹中的所有图像文件平均分成指定数量的组，便于数据划分。  
* **生成欠采样数据与掩码**:  
  * **掩码生成**: 可视化并生成多种2D采样掩码，包括**中心相位编码**、**中心矩形**、**径向**和**螺旋**采样。  
  * **轨迹生成**: 可视化并生成非笛卡尔采样的轨迹点（径向、螺旋）。  
  * **数据生成**: 将输入的全采样图像（如PNG）转换为k-space，然后根据选定的掩码或轨迹生成对应的欠采样k-space和掩码文件，用于训练或测试。  
* **批量重命名**: 为文件批量添加后缀，并复制到指定输出目录。  
* **划分训练/验证集**: 从训练集中随机抽取指定比例的数据（如25%）作为验证集，并自动移动到相应的验证文件夹，确保文件名的一致性。  

---  

#### **3. 技术特点与优势**  
* **用户友好**: 基于PyQt5开发，提供图形化界面，操作直观，无需编写代码。  
* **功能集成**: 将数据预处理、传统重建、优化算法和深度学习模型集成于一个平台，形成完整闭环。  
* **算法多样**: 涵盖了从经典优化到前沿AI的多种重建方法，满足不同研究和应用需求。  
* **GPU加速**: 支持使用GPU（通过CuPy）进行ADMM-TV重建，大幅提升计算效率。  
* **结果可视化**: 所有重建和处理结果均可在程序内实时可视化，方便用户快速评估效果。  
* **可扩展性强**: 代码结构清晰，易于添加新的重建算法或深度学习模型。  

#### **4. 专属模型训练能力 - 核心竞争优势**  
本程序最突出的优势在于其**强大的可训练性**。它不仅仅是一个推理工具，更是一个完整的**训练平台**。  

* **专属模型定制**: 用户可以根据自身特定的数据需求、设备型号或扫描协议，采集新的MRI数据。  
* **端到端训练**: 利用程序内置的数据处理工具（如“生成欠采样数据与掩码”），可以轻松地将新采集的全采样数据（`full`）转换为配对的欠采样数据（`undersampled`）和采样掩码（`mask`），构建专属的训练数据集。  
* **模型再训练**: 通过“训练”功能，用户可以直接使用新构建的数据集对U-Net、MoDL、Transformer或ISTA-Net等深度学习模型进行再训练或从头训练。  
* **成为领域专家**: 经过专属数据训练后的模型，将深刻理解特定场景下的图像特征和噪声模式，从而成为该领域的“专属图像重建专家”，其重建性能将远超使用通用数据集训练的模型，实现最佳的个性化重建效果。  

#### **5. 适用场景**  
本程序非常适合于：  
* MRI研究人员进行算法开发与性能对比。  
* 工程师快速验证不同重建方案的效果。  
* 教学演示压缩感知和深度学习在MR成像中的应用。  
* **科研机构或设备厂商，利用自身积累的高质量数据，训练并部署性能最优的专属AI重建模型。**  

总而言之，该程序不仅是一个强大的MRI图像处理工具箱，更是一个赋能用户打造**专属AI重建专家**的平台。它极大地简化了从数据采集、预处理、模型训练到最终部署的整个复杂流程，为加速MRI研究和临床应用提供了前所未有的支持。
